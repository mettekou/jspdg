<!DOCTYPE html>
<html>
	<head>
		<title>Uni-corn</title>
		<meta charset="UTF-8">
		<script src="js/jquery-2.2.1.min.js"></script>
		<script src="js/rpc.js"></script>
		<script src="js/rpc-data.js"></script>
		<script src="js/ractive-0.7.3.js"></script>
		<script src="js/watch.js"></script>
		<script src="js/objspy.js"></script>
		<script src="js/esprima-syntax.js"></script>
		<script src="js/redstone.js"></script>
		<script>REDSTONE.CRUMBS = {"rIYzcV6WabavZTUs8Wr3aCzTV6jkZ5DvS":{"idName":"rIYzcV6WabavZTUs8Wr3aCzTV6jkZ5DvS","variableNames":["tasks"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"tasks","isInCrumb":true}}]}},"roGyIw9PQi2dPKl4JWdedPqO8rDZRMVjH":{"idName":"roGyIw9PQi2dPKl4JWdedPqO8rDZRMVjH","variableNames":["taskTitle"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"taskTitle","isInCrumb":true}}]},"defaultValue":""},"r2seqXbgcphnbEqa9V2qC4TLcC2cimtYI":{"idName":"r2seqXbgcphnbEqa9V2qC4TLcC2cimtYI","variableNames":["taskPriority"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"taskPriority","isInCrumb":true}}]},"defaultValue":""},"rC8akZU8Hi2A8WsFb4GIMHaPSyn5E7GU6":{"idName":"rC8akZU8Hi2A8WsFb4GIMHaPSyn5E7GU6","variableNames":["meetings"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"meetings","isInCrumb":true}}]}},"rhD4UadI9IMdGPFpvOunOseAyUe8MLP91":{"idName":"rhD4UadI9IMdGPFpvOunOseAyUe8MLP91","variableNames":["meetingTitle"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"meetingTitle","isInCrumb":true}}]},"defaultValue":""},"renY8jSXmQfX0BAwbHXjPUkD0JI7aNyLl":{"idName":"renY8jSXmQfX0BAwbHXjPUkD0JI7aNyLl","variableNames":["meetingDate"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"meetingDate","isInCrumb":true}}]},"defaultValue":""},"rodXXPsGPzvhiBr1ZHpKnHS3dZmyjBSq5":{"idName":"rodXXPsGPzvhiBr1ZHpKnHS3dZmyjBSq5","variableNames":["meetingNotes"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"meetingNotes","isInCrumb":true}}]},"defaultValue":""},"r1mnEBznMtOkrAbviT2LcKQfQ9dDrY2Gg":{"idName":"r1mnEBznMtOkrAbviT2LcKQfQ9dDrY2Gg","variableNames":["activityToday"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"activityToday","isInCrumb":true}}]}},"r0p9iXEadTLMXgomdVBFe9GwP1c8lvTs2":{"idName":"r0p9iXEadTLMXgomdVBFe9GwP1c8lvTs2","variableNames":["activityToday"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"activityToday","isInCrumb":true}}]}},"r34y9qemgnTr9QcL14BioeidI2omHdK1i":{"idName":"r34y9qemgnTr9QcL14BioeidI2omHdK1i","variableNames":["activityToday"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"BinaryExpression","operator":">","left":{"type":"Identifier","name":"activityToday","isInCrumb":true},"right":{"type":"Literal","value":1}}}]}}};
REDSTONE.VARTOCRUMBID = {"tasks":["rIYzcV6WabavZTUs8Wr3aCzTV6jkZ5DvS"],"taskTitle":["roGyIw9PQi2dPKl4JWdedPqO8rDZRMVjH"],"taskPriority":["r2seqXbgcphnbEqa9V2qC4TLcC2cimtYI"],"meetings":["rC8akZU8Hi2A8WsFb4GIMHaPSyn5E7GU6"],"meetingTitle":["rhD4UadI9IMdGPFpvOunOseAyUe8MLP91"],"meetingDate":["renY8jSXmQfX0BAwbHXjPUkD0JI7aNyLl"],"meetingNotes":["rodXXPsGPzvhiBr1ZHpKnHS3dZmyjBSq5"],"activityToday":["r1mnEBznMtOkrAbviT2LcKQfQ9dDrY2Gg","r0p9iXEadTLMXgomdVBFe9GwP1c8lvTs2","r34y9qemgnTr9QcL14BioeidI2omHdK1i"]};
REDSTONE.EXPOSEDVALUES  = [{"expression":"taskTitle","crumb":{"idName":"roGyIw9PQi2dPKl4JWdedPqO8rDZRMVjH","variableNames":["taskTitle"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"taskTitle","isInCrumb":true}}]},"defaultValue":""},"onChangeEvent":false},{"expression":"taskPriority","crumb":{"idName":"r2seqXbgcphnbEqa9V2qC4TLcC2cimtYI","variableNames":["taskPriority"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"taskPriority","isInCrumb":true}}]},"defaultValue":""},"onChangeEvent":false},{"expression":"meetingTitle","crumb":{"idName":"rhD4UadI9IMdGPFpvOunOseAyUe8MLP91","variableNames":["meetingTitle"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"meetingTitle","isInCrumb":true}}]},"defaultValue":""},"onChangeEvent":false},{"expression":"meetingDate","crumb":{"idName":"renY8jSXmQfX0BAwbHXjPUkD0JI7aNyLl","variableNames":["meetingDate"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"meetingDate","isInCrumb":true}}]},"defaultValue":""},"onChangeEvent":false},{"expression":"meetingNotes","crumb":{"idName":"rodXXPsGPzvhiBr1ZHpKnHS3dZmyjBSq5","variableNames":["meetingNotes"],"parsedExpression":{"type":"Program","body":[{"type":"ExpressionStatement","expression":{"type":"Identifier","name":"meetingNotes","isInCrumb":true}}]},"defaultValue":""},"onChangeEvent":false}];
REDSTONE.EVENTS = [{"name":"displaySchedule","type":"click","idName":"r7uh5hsekwDFou6KDcb311sisP6AuGpYw"},{"name":"createCharts","type":"click","idName":"rCK4yGYyuj7dWQEasylb3igm29WOFpkzm"},{"name":"nextStatusTask","type":"click","idName":"rjPdHF5nxAvRX53noJzUuxMV1VFnpVcvf"},{"name":"addTaskUI","type":"click","idName":"rEsXNHVHaFCWnZ4AK7W15XPgYAw1p7p1D"},{"name":"editMeetingUI","type":"click","idName":"rCLmbMEblP0zQY6Qm6RGuDeE0JvfCuZpF"},{"name":"addMeetingUI","type":"click","idName":"r64N0ND8Nd8RsvOmT6ZOZPdxw99yz3JyE"}];

</script>
		<script src="js/async.min.js"></script>
		<link rel="stylesheet" type="text/css" href="css/loading.css">
		<script>$(document).ready(function() {
// --> Begin generated

REDSTONE.UPDATECLIENTVAR['taskTitle'] = function (newvalue) {
    taskTitle = newvalue;
};
REDSTONE.UPDATECLIENTVAR['taskPriority'] = function (newvalue) {
    taskPriority = newvalue;
};
REDSTONE.UPDATECLIENTVAR['meetingTitle'] = function (newvalue) {
    meetingTitle = newvalue;
};
REDSTONE.UPDATECLIENTVAR['meetingDate'] = function (newvalue) {
    meetingDate = newvalue;
};
REDSTONE.UPDATECLIENTVAR['meetingNotes'] = function (newvalue) {
    meetingNotes = newvalue;
};
REDSTONE.registerMethod("happenedInPast", happenedInPast);
REDSTONE.registerMethod("displaySchedule", displaySchedule);
REDSTONE.registerMethod("createCharts", createCharts);
REDSTONE.registerMethod("nextStatusTask", nextStatusTask);
REDSTONE.registerMethod("addTaskUI", addTaskUI);
REDSTONE.registerMethod("editMeetingUI", editMeetingUI);
REDSTONE.registerMethod("addMeetingUI", addMeetingUI);
REDSTONE.init();
// <-- End generated
});
</script>
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/bootstrap-theme.min.css">
		<link rel="stylesheet" href="css/font-awesome.min.css">
		<link rel="stylesheet" href="css/animate.css">
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css">
		<link rel="stylesheet" href="css/calendar.css">
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lobster">
		<script src="js/moment.js"></script>
		<script src="js/later.min.js"></script>
		<script src="js/transition.js"></script>
		<script src="js/collapse.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/bootstrap-datetimepicker.js"></script>
		<script src="js/jquery.appear.js"></script>
		<script src="js/jqBootstrapValidation.js"></script>
		<script src="js/modernizr.custom.js"></script>
		<script src="js/highcharts.js"></script>
		<script src="js/highcharts-3d.js"></script>
		<script src="js/highcharts-more.js"></script>
		<script src="js/modules/exporting.js"></script>
		<script src="js/underscore-min.js"></script>
		<script src="js/calendar.js"></script>
		<script src="js/client.js"></script>
	</head>
	<body>
		<div id="loading">
			<div class="loader"></div>
		</div>
		<div id="render-target"></div>
		<script type="text/ractive" id="main-template">
			<section class="text-center" id="logo-section">
				<div class="container">
					<div class="row">
						<div class="col-md-12">
							<div class="logo text-center">
								<h1>Uni-corn</h1>
								<span>Managing your uni-versity career</span>
							</div>
						</div>
					</div>
				</div>
			</section>
			<div class="mainbody-section text-center">
				<div class="container">
					<div class="row">
						<div class="col-md-3">
							<div class="menu-item blue">
								<a href="#calendar-modal" data-toggle="modal" on-click="r7uh5hsekwDFou6KDcb311sisP6AuGpYw">
									<i class="fa fa-calendar"></i>
									<p>Schedule</p>
								</a>
							</div>
							<div class="menu-item green">
								<a href="#tasks-modal" data-toggle="modal">
									<i class="fa fa-tasks"></i>
									<p>Tasks</p>
								</a>
							</div>
						</div>
						<div class="col-md-6">
							<img src="images/unicorn.png" class="img-responsive">
						</div>
						<div class="col-md-3">
							<div class="menu-item light-red">
								<a href="#meetings-modal" data-toggle="modal">
									<i class="fa fa-envelope-o"></i>
									<p>Meetings</p>
								</a>
							</div>
							<div class="menu-item color">
								<a href="#progress-modal" data-toggle="modal" on-click="rCK4yGYyuj7dWQEasylb3igm29WOFpkzm">
									<i class="fa fa-pie-chart"></i>
									<p>Progress</p>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="section-modal modal fade" tab-index="-1" role="dialog" aria-hidden="true" id="calendar-modal">
				<div class="modal-content">
					<div class="close-modal" data-dismiss="modal">
						<div class="lr">
							<div class="rl"></div>
						</div>
					</div>
					<div class="container">
						<div class="row">
							<div class="section-title text-center">
								<h3>Your Awesome Calendar</h3>
								<p>Always be yourself. Unless you can be a unicorn, then always be a unicorn.</p>
							</div>
						</div>
						<div class="row">
							<div class="pull-right form-inline">
								<div class="btn-group">
									<button class="btn btn-warning" data-calendar-view="year">Year</button>
									<button class="btn btn-warning" data-calendar-view="month">Month</button>
									<button class="btn btn-warning active" data-calendar-view="week">Week</button>
									<button class="btn btn-warning" data-calendar-view="day">Day</button>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="row">
								<div id="calendar"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="section-modal modal fade" tab-index="-1" role="dialog" aria-hidden="true" id="tasks-modal">
				<div class="modal-content">
					<div class="close-modal" data-dismiss="modal">
						<div class="lr">
							<div class="rl"></div>
						</div>
					</div>
					<div class="container">
						<div class="row">
							<div class="section-title text-center">
								<h3>Tasks</h3>
								<p>Being a person is getting too complicated. Time to be a unicorn.</p>
							</div>
						</div>
						<div class="row">
							<div class="col-md-8">
								<ul class="timeline">
																		{{#each rIYzcV6WabavZTUs8Wr3aCzTV6jkZ5DvS:__idx__}}
										<li data-idx =" {{__idx__}}" class="{{status < 1 ? "timeline-inverted" : ""}}">
											{{#if status == 1}}
												<div class="timeline-badge info">
													<i class="glyphicon glyphicon-check"></i>
												</div>
											{{else}}
												{{#if status == 0}}
													<div class="timeline-badge warning">
														<i class="glyphicon glyphicon-edit"></i>
													</div>
												{{else}}
													<div class="timeline-badge danger">
														<i class="glyphicon glyphicon-road"></i>
													</div>
												{{/if}}

											{{/if}}

											<div class="timeline-panel">
												<div class="timeline-heading">
													<h4 class="timeline-title">
														{{title}}
													</h4>
												</div>
												<div class="timeline-body">
													<button class="btn btn-info btn-sm" on-click="rjPdHF5nxAvRX53noJzUuxMV1VFnpVcvf">
														<i class="glyphicon glyphicon-check"></i>
													</button>
												</div>
											</div>
										</li>									{{/each}}

								</ul>
							</div>
							<div class="col-md-4">
								<a class="btn btn-default">
									<span class="glyphicon glyphicon-pencil"></span>
								</a>
								<div class="form-horizontal" id="task-form">
									<div class="form-group">
										<label for="task-title" class="control-label sr-only">Title</label>
										<div class="col-sm-10">
											<input value="{{roGyIw9PQi2dPKl4JWdedPqO8rDZRMVjH}}" class="form-control" placeholder="Title">
										</div>
									</div>
									<div class="form-group">
										<label for="taskPriority" class="control-label sr-only">Priority</label>
										<div class="col-sm-10">
											<input value="{{r2seqXbgcphnbEqa9V2qC4TLcC2cimtYI}}" class="form-control" placeholder="Priority (0-...)">
										</div>
									</div>
									<div class="form-group">
										<div class="col-sm-offset-2 col-sm-10">
											<button class="btn btn-success" id="send" on-click="rEsXNHVHaFCWnZ4AK7W15XPgYAw1p7p1D">
												<i class="glyphicon glyphicon-floppy-disk"></i>
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="section-modal modal fade" tab-index="-1" role="dialog" aria-hidden="true" id="meetings-modal">
				<div class="modal-content">
					<div class="close-modal" data-dismiss="modal">
						<div class="lr">
							<div class="rl"></div>
						</div>
					</div>
					<div class="container">
						<div class="row">
							<div class="section-title text-center">
								<h3>Meetings</h3>
								<p>Everything is better with a unicorn</p>
							</div>
						</div>
						<div class="row">
							<div class="col-md-8">
								<ul class="timeline">
																		{{#each rC8akZU8Hi2A8WsFb4GIMHaPSyn5E7GU6:__idx__}}
										<li data-idx =" {{__idx__}}" class="{{happenedInPast(start) ? "timeline-inverted" : ""}}">
											{{#if happenedInPast(start)}}
												<div class="timeline-badge info">
													<i class="glyphicon glyphicon-check"></i>
												</div>
											{{else}}
												<div class="timeline-badge danger">
													<i class="glyphicon glyphicon-road"></i>
												</div>
											{{/if}}

											<div class="timeline-panel">
												<div class="timeline-heading">
													<h4 class="timeline-title">
														{{title}}
													</h4>
													<p>
														<small class="text-muted">
															{{start.toLocaleString()}}
														</small>
													</p>
												</div>
												<div class="timeline-body">
													<p>
														{{notes}}
													</p>
													<button class="btn btn-info btn-sm" on-click="rCLmbMEblP0zQY6Qm6RGuDeE0JvfCuZpF">
														<i class="glyphicon glyphicon-edit"></i>
													</button>
												</div>
											</div>
										</li>									{{/each}}

								</ul>
							</div>
							<div class="col-md-4">
								<a class="btn btn-default">
									<span class="glyphicon glyphicon-pencil"></span>
								</a>
								<div class="form-horizontal" id="meeting-form">
									<div class="form-group">
										<label for="meeting-title" class="control-label sr-only">Title</label>
										<div class="col-sm-10">
											<input value="{{rhD4UadI9IMdGPFpvOunOseAyUe8MLP91}}" class="form-control" placeholder="Title">
										</div>
									</div>
									<div class="form-group">
										<div class="input-group date col-sm-8" style="padding-left:15px" id="meeting-starttime">
											<input type="text" class="form-control" value="{{renY8jSXmQfX0BAwbHXjPUkD0JI7aNyLl}}" id="meeting-start">
											<span class="input-group-addon">
												<span class="glyphicon glyphicon-calendar"></span>
											</span>
										</div>
									</div>
									<div class="form-group">
										<label for="meeting-description" class="control-label sr-only">Notes</label>
										<div class="col-sm-10">
											<textarea class="form-control" rows="3" value="{{rodXXPsGPzvhiBr1ZHpKnHS3dZmyjBSq5}}" id="meeting-description"></textarea>
										</div>
									</div>
									<div class="form-group">
										<div class="col-sm-offset-2 col-sm-10">
											<button class="btn btn-success" id="send" on-click="r64N0ND8Nd8RsvOmT6ZOZPdxw99yz3JyE">
												<i class="glyphicon glyphicon-floppy-disk"></i>
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="section-modal modal fade" tab-index="-1" role="dialog" aria-hidden="true" id="progress-modal">
				<div class="modal-content">
					<div class="close-modal" data-dismiss="modal">
						<div class="lr">
							<div class="rl"></div>
						</div>
					</div>
					<div class="container">
						<div class="row">
							<div class="section-title text-center">
								<h3>Progress</h3>
								<p>If someone says you're not a unicorn don't talk to them. You do not need that kind of negativity in your life.</p>
							</div>
						</div>
						<div class="row">
							<div class="text-center col-md-4 col-md-offset-4">
																{{#if r34y9qemgnTr9QcL14BioeidI2omHdK1i}}
									<h4>
										You updated {{r1mnEBznMtOkrAbviT2LcKQfQ9dDrY2Gg}} tasks today! Quite the busy bee! Ehm, unicorn!
									</h4>
								{{else}}
									<h4>
										You updated {{r0p9iXEadTLMXgomdVBFe9GwP1c8lvTs2}} tasks today. You may have stopped believing in unicorns, but they never stopped believing in you!
									</h4>
								{{/if}}

							</div>
							<div class="col-md-5" id="chartscontainer"></div>
							<div class="col-md-5" id="chartmeetingcontainer"></div>
						</div>
					</div>
				</div>
			</div>
			<script src="js/aux.js"></script>
		</script>
		<script>
var ractive = new Ractive({
    el: '#render-target',
    template: '#main-template',
    data: {
        rIYzcV6WabavZTUs8Wr3aCzTV6jkZ5DvS: undefined,
        roGyIw9PQi2dPKl4JWdedPqO8rDZRMVjH: '',
        r2seqXbgcphnbEqa9V2qC4TLcC2cimtYI: '',
        rC8akZU8Hi2A8WsFb4GIMHaPSyn5E7GU6: undefined,
        rhD4UadI9IMdGPFpvOunOseAyUe8MLP91: '',
        renY8jSXmQfX0BAwbHXjPUkD0JI7aNyLl: '',
        rodXXPsGPzvhiBr1ZHpKnHS3dZmyjBSq5: '',
        r1mnEBznMtOkrAbviT2LcKQfQ9dDrY2Gg: undefined,
        r0p9iXEadTLMXgomdVBFe9GwP1c8lvTs2: undefined,
        r34y9qemgnTr9QcL14BioeidI2omHdK1i: undefined,
        happenedInPast: happenedInPast
    }
});
</script>
	</body>

</html>
<!--
/* 	@config data: server, setup: server, displayMeetings: client, displayTasks: client, displaySchedule: client, displayCharts: client
	@slice data
*/
{
	/* @replicated */
	var meetings = [];
	/* @replicated */
	var tasks = [];
	/* @replicated */
	var courses = [];

	/* @replicated */
	function Meeting(title, notes, time) {
		this.title = title;
		this.notes = notes;
		this.start = new Date(time).getTime();
		this.end = addMinutes(new Date(time), 120);
	}

	/* @replicated */
	function Task(title, priority) {
		this.title = title;
		this.status = -1;
		this.priority = priority;
	}

	/* @observable */
	function Course(title, duration, time) {
		this.title = title;
		this.duration = duration;
		this.time = time;
	}
}

/* @slice getters+setters */
{
	function getMeetings() {
		return meetings;
	}
	function getTasks()   {
		return tasks;
	}
	function getCourses() {
		return courses;
	}
	function addTask(title, priority) {
		var task = new Task(title, priority);
		tasks.push(task);
	}
	function addMeeting(title, notes, time) {
		var meeting = new Meeting(title, notes, time);
		meetings.push(meeting);
	}
	function addCourse(title, duration, time) {
		var course = new Course(title, duration, time);
		courses.push(course);
	}

}

/* @slice sorting */
{
	function sortMeetings() {
	    var meetings = getMeetings();
		meetings.sort(function (m1, m2) {
			var first = m1.start;
			var second = m2.start;
			return first - second;
		});
	}

	function sortTasks () {
	    var tasks = getTasks();
		tasks.sort(function (t1, t2) {
			if (t1.status == t2.status) {
				return t1.priority - t2.priority;
			} else {
				return t1.status - t2.status;
			}
		})
	}
}

/* @slice setup */
{

	addTask("Learn uni-corn!", 10);

	var dataCourses = fs.readFile("data.json");
	var coursesJSON = JSON.parse(dataCourses);
	coursesJSON.forEach(function (json) {
		addCourse(json.title, json.duration, json.time);
	})
}

/* @slice time */
{
	later.date.localTime();

	function isValidTimeDescr (descr) {
		var sched = later.parse.text(descr);
		// no error => -1
		return sched.error === -1;
	}

	function happenedInPast(date) {
		var now = new Date().getTime();
		return date < now;
	}

	function addMinutes(date, minutes) {
		var ms = date.getTime();
		return new Date(ms + minutes * 60000);
	}

	function calculateNext(timeDescription) {
		var parsed = later.parse.text(timeDescription);
		var s = later.schedule(parsed);
		var next = s.next(1);
		return new Date(next);
	}

	function calculatePrevious(timeDescription) {
		var parsed = later.parse.text(timeDescription);
		var s = later.schedule(parsed);
		var next = s.prev(1);
		return new Date(next);
	}

	function happenedToday(date1, date2) {
		var year1 = date1.getFullYear();
		var year2 = date2.getFullYear();
		var month2 = date2.getMonth();
		var month1 = date1.getMonth();
		var day1 = date1.getDay();
		var day2 = date2.getDay();
		return year1 == year2 && month1 == month2 && day1 == day2;
	}
}


/* @slice statistics */
{
	var activityToday = 0;
	var latestUpdate = false;

	function updateActivity () {
		var now = new Date();
		if (latestUpdate) {
			if (happenedToday(latestUpdate, now)) {
				activityToday = activityToday + 1;
				latestUpdate = now;
			} else {
				activityToday = 1;
				latestUpdate = now;
			}
		} else {
			latestUpdate = now;
			activityToday = activityToday + 1;
		}
	}

	function processMeetingMonths () {
		var currYear = new Date().getFullYear();
		var months = [0,0,0,0,0,0,0,0,0,0,0,0];
		var meetings = getMeetings();
		meetings.forEach(function (meeting) {
			var date = new Date(meeting.start);
			var month = date.getMonth();
			var year = date.getFullYear();
			if (year == currYear)
				months[month] = months[month] + 1;
		});
		return months;
	}


	function processTasksStatus () {
		var todo = 0;
		var finished = 0;
		var inprogress = 0;
		var tasks = getTasks();
		tasks.forEach(function (task) {
			if (task.status < 0) {
				todo++;
			}
			else if (task.status > 0) {
				finished++;
			}
			else {
				inprogress++;
			}
		});
		return [todo, finished, inprogress]
	}
}

/* @slice displayMeetings */
{
	var meetingTitle = "";
	var meetingDate  = "";
	var meetingNotes = "";
	var currentlyEditingM = "";


	function addMeetingUI() {
		if (currentlyEditingM) {
			currentlyEditingM.title = meetingTitle;
			currentlyEditingM.start = meetingDate;
			currentlyEditingM.notes = meetingNotes;
			currentlyEditingM = false;
		} else {
			addMeeting(meetingTitle, meetingNotes, meetingDate);
		}
		sortMeetings();
		meetingTitle = "";
		meetingDate = "";
		meetingNotes = "";
	}

	function editMeetingUI(ev) {
		var idx = ev.index;
		var meetings = getMeetings();
		currentlyEditingM = meetings[idx];
		var dateS = currentlyEditingM.start;
		meetingTitle = currentlyEditingM.title;
		meetingNotes = currentlyEditingM.notes;
		meetingDate = new Date(dateS);
		sortMeetings();
	}

}

/* @slice displayTasks */
{
	var taskTitle = "";
	var taskPriority = "";


	function addTaskUI() {
		addTask(taskTitle, taskPriority);
		sortTasks();
		taskTitle = "";
		taskPriority = "";
	}

	function nextStatusTask (ev) {
		var idx = ev.index;
		var tasks = getTasks();
		var task = tasks[idx];
		var now = new Date();
		if (task.status < 1) {
			task.status = task.status + 1;
			task.lastUpdate = now.getTime();
		}
		updateActivity();
		sortTasks();
	}
}


/* @slice displayCharts */
{
	function createTaskChart () {
		var stats = processTasksStatus();
		var todo = {name: 'to start', y: stats[0]};
		var finished = {name: 'finished', y: stats[1]};
		var inprogress = {name: 'in progress', y: stats[2]};
		var chart = {
			chart: {type: 'pie', options3d: {
				enabled: true,
				alpha: 45
			}},
			title: {text: 'Tasks'},
			plotOptions: { pie: { innerSize: 100, depth: 45 }},
			colors: ['#249AA7', '#ABD25E', '#F1594A', '#F8C830'],
			series: [{
				name: 'Tasks',
				data: [finished, todo, inprogress]
			}]
		}
		$("#chartscontainer").highcharts(chart);
	}

	function createMeetingChart() {
		var options = Highcharts.getOptions();
		var months = processMeetingMonths();
		var chart =  {
			chart: {type:'column', options3d: {enabled:true, alpha:10, beta:25, depth:70} },
			title: {text: 'Meetings this year'},
			colors: ['#249AA7', '#ABD25E', '#F1594A', '#F8C830'],
			plotOptions: {column: {depth: 25}},
			xAxis: {categories: options.lang.shortMonths},
			yAxis: { title: { text: null}},
			series: [{
				name: 'Meetings',
				data: months
			}]
		};
		$("#chartmeetingcontainer").highcharts(chart);
	}

	function createCharts() {
		createTaskChart();
		createMeetingChart();
	}
}

/* @slice displaySchedule */
{


	function displaySchedule() {
		var schedule = [];
		var meetings = getMeetings();
		var courses = getCourses();
		meetings.forEach(function (appointment) {
			appointment.class= "event-info";
			schedule.push(appointment);
		});
		courses.forEach(function (course) {
			var nextDate = calculateNext(course.time);
			var prevDate = calculatePrevious(course.time);
			var endNextDate = addMinutes(nextDate, course.duration);
			var endPrevDate = addMinutes(prevDate, course.duration);
			var next = {title: course.title, start: nextDate.getTime(), end: endNextDate.getTime(), class: "event-info"};
			var prev = {title: course.title, start: prevDate.getTime(), end: endPrevDate.getTime(), class: "event-info"};
			schedule.push(next);
			schedule.push(prev);
		});
		var calendar = $("#calendar").calendar({
			tmpl_path : "tmpls/",
			view : "week",
			events_source: schedule
		});
		calendar.view();
	}
}

/* @ui */
head
	title Uni-corn
	link[rel=stylesheet][href=css/bootstrap.min.css]
	link[rel=stylesheet][href=css/bootstrap-theme.min.css]
	link[rel=stylesheet][href=css/font-awesome.min.css]
	link[rel=stylesheet][href=css/animate.css]
	link[rel=stylesheet][href=css/style.css]
	link[rel=stylesheet][href=css/bootstrap-datetimepicker.min.css]
	link[rel=stylesheet][href=css/calendar.css]
	link[rel=stylesheet][href=http://fonts.googleapis.com/css?family=Lobster]
	script[src=js/moment.js]
	script[src=js/later.min.js]
	script[src=js/transition.js]
	script[src=js/collapse.js]
	script[src=js/bootstrap.min.js]
	script[src=js/bootstrap-datetimepicker.js]
	script[src=js/jquery.appear.js]
	script[src=js/jqBootstrapValidation.js]
	script[src=js/modernizr.custom.js]
	script[src=js/highcharts.js]
	script[src=js/highcharts-3d.js]
	script[src=js/highcharts-more.js]
	script[src=js/modules/exporting.js]
	script[src=js/underscore-min.js]
	script[src=js/calendar.js]
body

	section#logo-section[class=text-center]
		div[class=container]
			div[class=row]
				div[class=col-md-12]
					div[class=logo text-center]
						h1 Uni-corn
						span Managing your uni-versity career
	div[class=mainbody-section text-center]
		div[class=container]
			div[class=row]
				div[class=col-md-3]
					div[class=menu-item blue]
						a[href=#calendar-modal][data-toggle=modal][@click=displaySchedule]
							i[class=fa fa-calendar]
							p Schedule
					div[class=menu-item green]
						a[href=#tasks-modal][data-toggle=modal]
							i[class=fa fa-tasks]
							p Tasks
				div[class=col-md-6]
					img[src=images/unicorn.png][class=img-responsive]
				div[class=col-md-3]
					div[class=menu-item light-red]
						a[href=#meetings-modal][data-toggle=modal]
							i[class=fa fa-envelope-o]
							p Meetings
					div[class=menu-item color]
						a[href=#progress-modal][data-toggle=modal][@click=createCharts]
							i[class=fa fa-pie-chart]
							p Progress

	div#calendar-modal[class=section-modal modal fade][tab-index=-1][role=dialog][aria-hidden=true]
		div[class=modal-content]
			div[class=close-modal][data-dismiss=modal]
				div[class=lr]
					div[class=rl]
			div[class=container]
				div[class=row]
					div[class=section-title text-center]
						h3 Your Awesome Calendar
						p Always be yourself. Unless you can be a unicorn, then always be a unicorn.
				div[class=row]
					div[class=pull-right form-inline]
						div[class=btn-group]
							button[class=btn btn-warning][data-calendar-view=year] Year
							button[class=btn btn-warning][data-calendar-view=month] Month
							button[class=btn btn-warning active][data-calendar-view=week] Week
							button[class=btn btn-warning][data-calendar-view=day] Day
				div[class=row]
					div[class=row]
						div#calendar
	div#tasks-modal[class=section-modal modal fade][tab-index=-1][role=dialog][aria-hidden=true]
		div[class=modal-content]
			div[class=close-modal][data-dismiss=modal]
				div[class=lr]
					div[class=rl]
			div[class=container]
				div[class=row]
					div[class=section-title text-center]
						h3 Tasks
						p Being a person is getting too complicated. Time to be a unicorn.
				div[class=row]
					div[class=col-md-8]
						ul[class=timeline]
							{{#each tasks}}
								li[data-idx = {{__idx__}}][class={{status < 1 ? "timeline-inverted" : ""}}]
									{{#if status == 1}}
										div[class=timeline-badge info]
											i[class=glyphicon glyphicon-check]
									{{#else}}
										{{#if status == 0}}
											div[class=timeline-badge warning]
												i[class=glyphicon glyphicon-edit]
										{{#else}}
											div[class=timeline-badge danger]
												i[class=glyphicon glyphicon-road]
									div[class=timeline-panel]
										div[class=timeline-heading]
											h4[class=timeline-title] {{title}}

										div[class=timeline-body]
											button[@click=nextStatusTask][class=btn btn-info btn-sm]
												i[class=glyphicon glyphicon-check]


					div[class=col-md-4]
						a[class=btn btn-default]
							span[class=glyphicon glyphicon-pencil]
						div#task-form[class=form-horizontal]
							div[class=form-group]
								label[for=task-title][class=control-label sr-only] Title
								div[class=col-sm-10]
									input[value={{taskTitle}}][class=form-control][placeholder=Title]
							div[class=form-group]
								label[for=taskPriority][class=control-label sr-only] Priority
								div[class=col-sm-10]
									input[value={{taskPriority}}][class=form-control][placeholder=Priority (0-...)]
							div[class=form-group]
								div[class=col-sm-offset-2 col-sm-10]
									button[@click=addTaskUI][class=btn btn-success]#send
										i[class=glyphicon glyphicon-floppy-disk]

	div#meetings-modal[class=section-modal modal fade][tab-index=-1][role=dialog][aria-hidden=true]
		div[class=modal-content]
			div[class=close-modal][data-dismiss=modal]
				div[class=lr]
					div[class=rl]
			div[class=container]
				div[class=row]
					div[class=section-title text-center]
						h3 Meetings
						p Everything is better with a unicorn
				div[class=row]
					div[class=col-md-8]
						ul[class=timeline]
							{{#each meetings}}
								li[data-idx = {{__idx__}}][class={{happenedInPast(start) ? "timeline-inverted" : ""}}]
									{{#if happenedInPast(start)}}
										div[class=timeline-badge info]
											i[class=glyphicon glyphicon-check]
									{{#else}}
										div[class=timeline-badge danger]
											i[class=glyphicon glyphicon-road]
									div[class=timeline-panel]
										div[class=timeline-heading]
											h4[class=timeline-title] {{title}}
											p
												small[class=text-muted] {{start.toLocaleString()}}
										div[class=timeline-body]
											p {{notes}}
											button[@click=editMeetingUI][class=btn btn-info btn-sm]
												i[class=glyphicon glyphicon-edit]


					div[class=col-md-4]
						a[class=btn btn-default]
							span[class=glyphicon glyphicon-pencil]
						div#meeting-form[class=form-horizontal]
							div[class=form-group]
								label[for=meeting-title][class=control-label sr-only] Title
								div[class=col-sm-10]
									input[value={{meetingTitle}}][class=form-control][placeholder=Title]
							div[class=form-group]
								div#meeting-starttime[class=input-group date col-sm-8][style=padding-left:15px]
									input#meeting-start[type=text][class=form-control][value={{meetingDate}}]
									span[class=input-group-addon]
										span[class=glyphicon glyphicon-calendar]
							div[class=form-group]
								label[for=meeting-description][class=control-label sr-only] Notes
								div[class=col-sm-10]
									textarea#meeting-description[class=form-control][rows=3][value={{meetingNotes}}]
							div[class=form-group]
								div[class=col-sm-offset-2 col-sm-10]
									button[@click=addMeetingUI][class=btn btn-success]#send
										i[class=glyphicon glyphicon-floppy-disk]

	div#progress-modal[class=section-modal modal fade][tab-index=-1][role=dialog][aria-hidden=true]
		div[class=modal-content]
			div[class=close-modal][data-dismiss=modal]
				div[class=lr]
					div[class=rl]
			div[class=container]
				div[class=row]
					div[class=section-title text-center]
						h3 Progress
						p If someone says you're not a unicorn don't talk to them. You do not need that kind of negativity in your life.
				div[class=row]
					div[class=text-center col-md-4 col-md-offset-4]
						{{#if activityToday > 1}}
							h4 You updated {{activityToday}} tasks today! Quite the busy bee! Ehm, unicorn!
						{{#else}}
							h4 You updated {{activityToday}} tasks today. You may have stopped believing in unicorns, but they never stopped believing in you!
					div#chartscontainer[class=col-md-5]
					div#chartmeetingcontainer[class=col-md-5]

	script[src=js/aux.js]

-->
